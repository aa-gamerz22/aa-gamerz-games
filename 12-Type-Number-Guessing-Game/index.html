<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fixed Number Guessing Game</title>
    <link rel="stylesheet" href="css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #1a2a6c, #b21f1f, #1a2a6c);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            color: #fff;
            overflow-x: hidden;
        }

        .container {
            width: 100%;
            max-width: 1200px;
            background: rgba(0, 0, 30, 0.85);
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.5);
            min-height: 90vh;
            display: flex;
            flex-direction: column;
        }

        .header {
            background: rgba(10, 20, 40, 0.9);
            padding: 20px;
            text-align: center;
            border-bottom: 3px solid #4a90e2;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 5px;
            color: #4a90e2;
            text-shadow: 0 0 10px rgba(74, 144, 226, 0.5);
        }

        .header p {
            color: #a0c4ff;
            font-size: 1.1rem;
        }

        .content-area {
            display: flex;
            flex: 1;
            position: relative;
            min-height: 500px;
        }

        /* Sidebar Styles */
        .sidebar {
            width: 250px;
            background: rgba(15, 30, 60, 0.95);
            padding: 20px 0;
            border-right: 2px solid #4a90e2;
        }

        .nav-btn {
            display: flex;
            align-items: center;
            padding: 15px 25px;
            color: #d0e0ff;
            font-size: 1.1rem;
            text-decoration: none;
            transition: all 0.3s ease;
            cursor: pointer;
            border-left: 4px solid transparent;
        }

        .nav-btn:hover {
            background: rgba(74, 144, 226, 0.2);
            color: #fff;
            border-left: 4px solid #4a90e2;
        }

        .nav-btn i {
            margin-right: 15px;
            font-size: 1.2rem;
        }

        .nav-btn.active {
            background: rgba(74, 144, 226, 0.3);
            color: #fff;
            border-left: 4px solid #4a90e2;
        }

        /* Main Content Styles */
        .main-content {
            flex: 1;
            padding: 30px;
            position: relative;
            overflow-y: auto;
            max-height: calc(100vh - 200px);
        }

        .screen {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .screen.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Home Screen */
        .home-content {
            text-align: center;
            padding: 40px 20px;
        }

        .home-content h2 {
            font-size: 2.8rem;
            margin-bottom: 20px;
            color: #4a90e2;
        }

        .home-content p {
            font-size: 1.2rem;
            max-width: 700px;
            margin: 0 auto 40px;
            line-height: 1.6;
            color: #c9d7f0;
        }

        .action-btn {
            display: inline-block;
            padding: 15px 40px;
            background: linear-gradient(to right, #4a90e2, #5fa5ff);
            color: white;
            border: none;
            border-radius: 50px;
            font-size: 1.2rem;
            font-weight: 600;
            margin: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .action-btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.4);
            background: linear-gradient(to right, #5fa5ff, #6fb1ff);
        }

        .action-btn i {
            margin-left: 10px;
        }

        .features {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 50px;
            gap: 30px;
        }

        .feature-card {
            background: rgba(25, 50, 100, 0.7);
            border-radius: 15px;
            padding: 25px;
            width: 250px;
            text-align: center;
            transition: all 0.3s ease;
            border: 1px solid #4a90e2;
        }

        .feature-card:hover {
            transform: translateY(-10px);
            background: rgba(35, 70, 140, 0.8);
        }

        .feature-card i {
            font-size: 3rem;
            color: #4a90e2;
            margin-bottom: 20px;
        }

        .feature-card h3 {
            font-size: 1.5rem;
            margin-bottom: 15px;
            color: #fff;
        }

        .feature-card p {
            font-size: 1rem;
            color: #c9d7f0;
            margin-bottom: 0;
        }

        /* Game Screen */
        .game-container {
            max-width: 600px;
            margin: 0 auto;
            text-align: center;
            background: rgba(15, 30, 60, 0.7);
            padding: 30px;
            border-radius: 15px;
            border: 2px solid #4a90e2;
        }

        .game-header {
            margin-bottom: 25px;
        }

        .game-header h2 {
            font-size: 2rem;
            color: #4a90e2;
            margin-bottom: 10px;
        }

        .level-info {
            display: flex;
            justify-content: space-between;
            background: rgba(25, 50, 100, 0.5);
            padding: 10px 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .info-item {
            text-align: center;
        }

        .info-label {
            font-size: 0.9rem;
            color: #a0c4ff;
        }

        .info-value {
            font-size: 1.3rem;
            font-weight: bold;
            color: #fff;
        }

        .game-input {
            width: 100%;
            padding: 15px;
            font-size: 1.5rem;
            text-align: center;
            border: 2px solid #4a90e2;
            border-radius: 10px;
            background: rgba(0, 0, 30, 0.7);
            color: white;
            margin: 20px 0;
        }

        .game-message {
            min-height: 30px;
            font-size: 1.2rem;
            margin: 15px 0;
            color: #ffcc00;
        }

        .chances {
            font-size: 1.1rem;
            margin: 10px 0;
            color: #a0c4ff;
        }

        .chances span {
            color: #ffcc00;
            font-weight: bold;
        }

        .game-btn {
            padding: 12px 30px;
            background: linear-gradient(to right, #4a90e2, #5fa5ff);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: 600;
            margin: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .game-btn:hover {
            background: linear-gradient(to right, #5fa5ff, #6fb1ff);
            transform: translateY(-3px);
        }

        .game-btn.secondary {
            background: rgba(255, 255, 255, 0.1);
        }

        /* Level Selection */
        .levels-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .level-card {
            background: rgba(25, 50, 100, 0.7);
            border-radius: 10px;
            padding: 20px 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid #4a90e2;
            position: relative;
        }

        .level-card:hover {
            transform: scale(1.05);
            background: rgba(35, 70, 140, 0.8);
        }

        .level-card.locked {
            background: rgba(50, 50, 70, 0.5);
            border-color: #666;
            cursor: not-allowed;
        }

        .level-card.locked .level-number {
            color: #888;
        }

        .level-number {
            font-size: 2rem;
            font-weight: bold;
            color: #4a90e2;
            margin-bottom: 10px;
        }

        .level-difficulty {
            font-size: 0.9rem;
            color: #ffcc00;
        }

        .level-card.locked .lock-icon {
            display: block;
        }

        .lock-icon {
            position: absolute;
            top: 10px;
            right: 10px;
            color: #ffcc00;
            display: none;
        }

        /* History Screen */
        .history-container {
            overflow-x: auto;
        }

        .history-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background: rgba(25, 50, 100, 0.5);
        }

        .history-table th {
            background: rgba(74, 144, 226, 0.7);
            padding: 15px;
            text-align: left;
        }

        .history-table td {
            padding: 12px 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .history-table tr:hover {
            background: rgba(35, 70, 140, 0.5);
        }

        .win {
            color: #4caf50;
            font-weight: bold;
        }

        .lose {
            color: #f44336;
            font-weight: bold;
        }

        /* Settings Screen */
        .settings-container {
            max-width: 600px;
            margin: 0 auto;
        }

        .setting-group {
            background: rgba(25, 50, 100, 0.5);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 25px;
            border: 1px solid #4a90e2;
        }

        .setting-title {
            font-size: 1.4rem;
            color: #4a90e2;
            margin-bottom: 15px;
        }

        .setting-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .setting-item:last-child {
            border-bottom: none;
        }

        .setting-label {
            font-size: 1.1rem;
        }

        .switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 34px;
        }

        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 34px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 26px;
            width: 26px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .slider {
            background-color: #4a90e2;
        }

        input:checked + .slider:before {
            transform: translateX(26px);
        }

        .reset-all-btn {
            display: block;
            width: 100%;
            padding: 15px;
            background: linear-gradient(to right, #e24a4a, #ff5f5f);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: 600;
            margin: 20px 0;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .reset-all-btn:hover {
            background: linear-gradient(to right, #ff5f5f, #ff6f6f);
            transform: translateY(-3px);
        }

        /* Help Screen */
        .help-container {
            max-width: 800px;
            margin: 0 auto;
        }

        .help-section {
            background: rgba(25, 50, 100, 0.5);
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 25px;
            border: 1px solid #4a90e2;
        }

        .help-title {
            font-size: 1.6rem;
            color: #4a90e2;
            margin-bottom: 20px;
        }

        .help-content {
            line-height: 1.7;
        }

        .help-content p {
            margin-bottom: 15px;
        }

        .help-content ul {
            padding-left: 30px;
            margin: 15px 0;
        }

        .help-content li {
            margin-bottom: 10px;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .sidebar {
                width: 70px;
            }
            
            .nav-btn span {
                display: none;
            }
            
            .nav-btn i {
                margin-right: 0;
                font-size: 1.5rem;
            }
            
            .home-content h2 {
                font-size: 2rem;
            }
            
            .feature-card {
                width: 100%;
                max-width: 300px;
            }
        }

        @media (max-width: 480px) {
            .container {
                min-height: 95vh;
            }
            
            .header h1 {
                font-size: 1.8rem;
            }
            
            .action-btn {
                padding: 12px 25px;
                font-size: 1rem;
            }
            
            .level-card {
                padding: 15px 5px;
            }
            
            .level-number {
                font-size: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Fixed Number Guessing Game</h1>
            <p>All buttons now work perfectly!</p>
        </div>
        
        <div class="content-area">
            <div class="sidebar">
                <div class="nav-btn active" data-screen="home">
                    <i class="fas fa-home"></i>
                    <span>Home</span>
                </div>
                <div class="nav-btn" data-screen="game">
                    <i class="fas fa-play-circle"></i>
                    <span>Play Game</span>
                </div>
                <div class="nav-btn" data-screen="levels">
                    <i class="fas fa-layer-group"></i>
                    <span>Levels</span>
                </div>
                <div class="nav-btn" data-screen="history">
                    <i class="fas fa-history"></i>
                    <span>Game History</span>
                </div>
                <div class="nav-btn" data-screen="settings">
                    <i class="fas fa-cog"></i>
                    <span>Settings</span>
                </div>
                <div class="nav-btn" data-screen="help">
                    <i class="fas fa-question-circle"></i>
                    <span>Help</span>
                </div>
            </div>
            
            <div class="main-content">
                <!-- Home Screen -->
                <div class="screen active" id="home-screen">
                    <div class="home-content">
                        <h2>Welcome to the Fixed Game!</h2>
                        <p>All buttons and screens are now fully functional. Try navigating between screens!</p>
                        
                        <button class="action-btn" id="start-game-btn">
                            Start Game <i class="fas fa-arrow-right"></i>
                        </button>
                        <button class="action-btn" id="select-level-btn">
                            Select Level <i class="fas fa-layer-group"></i>
                        </button>
                        
                        <div class="features">
                            <div class="feature-card">
                                <i class="fas fa-check-circle"></i>
                                <h3>Fixed Buttons</h3>
                                <p>All navigation and action buttons work perfectly now</p>
                            </div>
                            
                            <div class="feature-card">
                                <i class="fas fa-exchange-alt"></i>
                                <h3>Smooth Transitions</h3>
                                <p>Seamless screen switching with animations</p>
                            </div>
                            
                            <div class="feature-card">
                                <i class="fas fa-gamepad"></i>
                                <h3>Playable Game</h3>
                                <p>Fully functional number guessing mechanics</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Game Screen -->
                <div class="screen" id="game-screen">
                    <div class="game-container">
                        <div class="game-header">
                            <h2>Guess the Number</h2>
                            <p>Level <span id="current-level">1</span> - <span id="level-desc">Beginner</span></p>
                        </div>
                        
                        <div class="level-info">
                            <div class="info-item">
                                <div class="info-label">Range</div>
                                <div class="info-value">1 - <span id="max-number">100</span></div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">Best Score</div>
                                <div class="info-value" id="best-score">N/A</div>
                            </div>
                        </div>
                        
                        <input type="number" id="guess-input" class="game-input" placeholder="Enter your guess..." min="1">
                        <div class="game-message" id="game-message">Enter a number between 1 and 100</div>
                        <div class="chances">Remaining chances: <span id="remaining-chances">10</span></div>
                        
                        <button class="game-btn" id="check-btn">Check</button>
                        <button class="game-btn secondary" id="new-game-btn">New Game</button>
                        <button class="game-btn secondary" id="back-to-levels-btn">Back to Levels</button>
                    </div>
                </div>
                
                <!-- Level Selection Screen -->
                <div class="screen" id="levels-screen">
                    <h2>Select a Level</h2>
                    <p>Complete each level to unlock the next. Good luck!</p>
                    
                    <div class="levels-container" id="levels-container">
                        <!-- Levels will be generated by JavaScript -->
                    </div>
                </div>
                
                <!-- History Screen -->
                <div class="screen" id="history-screen">
                    <h2>Game History</h2>
                    <p>Your previous game results and statistics</p>
                    
                    <div class="history-container">
                        <table class="history-table">
                            <thead>
                                <tr>
                                    <th>Date</th>
                                    <th>Level</th>
                                    <th>Result</th>
                                    <th>Time</th>
                                    <th>Accuracy</th>
                                    <th>Score</th>
                                </tr>
                            </thead>
                            <tbody id="history-body">
                                <tr>
                                    <td>2023-07-15 14:30</td>
                                    <td>1</td>
                                    <td class="win">Win</td>
                                    <td>22 sec</td>
                                    <td>80%</td>
                                    <td>85</td>
                                </tr>
                                <tr>
                                    <td>2023-07-15 15:45</td>
                                    <td>2</td>
                                    <td class="lose">Lose</td>
                                    <td>45 sec</td>
                                    <td>N/A</td>
                                    <td>0</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    
                    <div style="margin-top: 20px; text-align: center;">
                        <button class="action-btn" id="reset-history-btn">Reset History</button>
                    </div>
                </div>
                
                <!-- Settings Screen -->
                <div class="screen" id="settings-screen">
                    <h2>Game Settings</h2>
                    <p>Customize your gaming experience</p>
                    
                    <div class="settings-container">
                        <div class="setting-group">
                            <h3 class="setting-title">Game Options</h3>
                            <div class="setting-item">
                                <span class="setting-label">Sound Effects</span>
                                <label class="switch">
                                    <input type="checkbox" id="sound-toggle" checked>
                                    <span class="slider"></span>
                                </label>
                            </div>
                            <div class="setting-item">
                                <span class="setting-label">Vibration</span>
                                <label class="switch">
                                    <input type="checkbox" id="vibration-toggle">
                                    <span class="slider"></span>
                                </label>
                            </div>
                            <div class="setting-item">
                                <span class="setting-label">Show Hints</span>
                                <label class="switch">
                                    <input type="checkbox" id="hints-toggle" checked>
                                    <span class="slider"></span>
                                </label>
                            </div>
                        </div>
                        
                        <div class="setting-group">
                            <h3 class="setting-title">Difficulty</h3>
                            <div class="setting-item">
                                <span class="setting-label">Starting Level</span>
                                <select id="start-level" class="game-input" style="width: 100px; display: inline-block; padding: 5px;">
                                    <option value="1">Level 1</option>
                                    <option value="5">Level 5</option>
                                    <option value="10">Level 10</option>
                                </select>
                            </div>
                        </div>
                        
                        <button id="reset-all-btn" class="reset-all-btn">
                            <i class="fas fa-trash-alt"></i> Reset All Game Data
                        </button>
                    </div>
                </div>
                
                <!-- Help Screen -->
                <div class="screen" id="help-screen">
                    <div class="help-container">
                        <h2>Game Help & Instructions</h2>
                        
                        <div class="help-section">
                            <h3 class="help-title">How to Play</h3>
                            <div class="help-content">
                                <p>Welcome to the Fixed Number Guessing Game! All buttons are now working perfectly.</p>
                                
                                <p><strong>Game Rules:</strong></p>
                                <ul>
                                    <li>A random number is generated within the specified range</li>
                                    <li>You have a limited number of chances to guess the number</li>
                                    <li>After each guess, you'll receive feedback</li>
                                    <li>Guess correctly to win and unlock the next level</li>
                                </ul>
                            </div>
                        </div>
                        
                        <div class="help-section">
                            <h3 class="help-title">Button Fixes</h3>
                            <div class="help-content">
                                <p>All issues with buttons not working have been resolved:</p>
                                <ul>
                                    <li>Navigation buttons switch screens properly</li>
                                    <li>Game buttons (Check, New Game) work correctly</li>
                                    <li>Action buttons trigger appropriate functions</li>
                                    <li>Screen transitions are smooth and reliable</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Game state management
        const gameState = {
            currentLevel: 1,
            maxLevel: 50,
            secretNumber: 0,
            remainingChances: 10,
            gameStarted: false,
            startTime: 0,
            unlockedLevels: [1],
            gameHistory: [],
            settings: {
                sound: true,
                vibration: false,
                hints: true,
                startLevel: 1
            }
        };

        // DOM Elements
        const screens = {
            home: document.getElementById('home-screen'),
            game: document.getElementById('game-screen'),
            levels: document.getElementById('levels-screen'),
            history: document.getElementById('history-screen'),
            settings: document.getElementById('settings-screen'),
            help: document.getElementById('help-screen')
        };

        const navButtons = document.querySelectorAll('.nav-btn');
        const startGameBtn = document.getElementById('start-game-btn');
        const selectLevelBtn = document.getElementById('select-level-btn');
        const levelsContainer = document.getElementById('levels-container');
        const historyBody = document.getElementById('history-body');
        const resetHistoryBtn = document.getElementById('reset-history-btn');
        const resetAllBtn = document.getElementById('reset-all-btn'); // New reset all button
        const gameMessage = document.getElementById('game-message');
        const guessInput = document.getElementById('guess-input');
        const checkBtn = document.getElementById('check-btn');
        const newGameBtn = document.getElementById('new-game-btn');
        const backToLevelsBtn = document.getElementById('back-to-levels-btn');
        const remainingChancesEl = document.getElementById('remaining-chances');
        const currentLevelEl = document.getElementById('current-level');
        const maxNumberEl = document.getElementById('max-number');
        const levelDescEl = document.getElementById('level-desc');
        const bestScoreEl = document.getElementById('best-score');
        const soundToggle = document.getElementById('sound-toggle');
        const vibrationToggle = document.getElementById('vibration-toggle');
        const hintsToggle = document.getElementById('hints-toggle');
        const startLevelSelect = document.getElementById('start-level');

        // Initialize the game
        function initGame() {
            loadGameData();
            setupEventListeners();
            renderLevels();
            renderHistory();
            applySettings();
        }

        // Load game data from localStorage
        function loadGameData() {
            const savedData = localStorage.getItem('numberGuessingGame');
            if (savedData) {
                const data = JSON.parse(savedData);
                gameState.unlockedLevels = data.unlockedLevels || [1];
                gameState.gameHistory = data.gameHistory || [];
                gameState.settings = data.settings || gameState.settings;
            }
        }

        // Save game data to localStorage
        function saveGameData() {
            const data = {
                unlockedLevels: gameState.unlockedLevels,
                gameHistory: gameState.gameHistory,
                settings: gameState.settings
            };
            localStorage.setItem('numberGuessingGame', JSON.stringify(data));
        }

        // Setup event listeners
        function setupEventListeners() {
            // Navigation buttons
            navButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const screen = button.getAttribute('data-screen');
                    showScreen(screen);
                    
                    // Update active button
                    navButtons.forEach(btn => btn.classList.remove('active'));
                    button.classList.add('active');
                });
            });

            // Start game button
            startGameBtn.addEventListener('click', () => {
                showScreen('game');
                startNewGame(gameState.settings.startLevel);
            });

            // Select level button
            selectLevelBtn.addEventListener('click', () => {
                showScreen('levels');
            });

            // Game controls
            checkBtn.addEventListener('click', checkGuess);
            newGameBtn.addEventListener('click', () => startNewGame(gameState.currentLevel));
            backToLevelsBtn.addEventListener('click', () => showScreen('levels'));
            resetHistoryBtn.addEventListener('click', resetHistory);
            resetAllBtn.addEventListener('click', resetAllData); // New reset all event listener

            // Input field - allow Enter key to submit guess
            guessInput.addEventListener('keyup', (e) => {
                if (e.key === 'Enter') {
                    checkGuess();
                }
            });

            // Settings controls
            soundToggle.addEventListener('change', updateSetting);
            vibrationToggle.addEventListener('change', updateSetting);
            hintsToggle.addEventListener('change', updateSetting);
            startLevelSelect.addEventListener('change', updateSetting);
        }

        // Show a specific screen
        function showScreen(screenName) {
            // Hide all screens
            Object.values(screens).forEach(screen => {
                screen.classList.remove('active');
            });
            
            // Show the requested screen
            if (screens[screenName]) {
                screens[screenName].classList.add('active');
            }
            
            // Special handling for certain screens
            if (screenName === 'levels') {
                renderLevels();
            } else if (screenName === 'history') {
                renderHistory();
            }
        }

        // Start a new game
        function startNewGame(level) {
            gameState.currentLevel = level;
            gameState.gameStarted = true;
            gameState.startTime = new Date();
            
            // Set level-specific parameters
            let maxNumber, chances;
            if (level <= 10) {
                maxNumber = 100;
                chances = 10;
            } else if (level <= 20) {
                maxNumber = 200;
                chances = 9;
            } else if (level <= 30) {
                maxNumber = 500;
                chances = 8;
            } else if (level <= 40) {
                maxNumber = 1000;
                chances = 7;
            } else {
                maxNumber = 2000;
                chances = 6;
            }
            
            gameState.remainingChances = chances;
            gameState.secretNumber = Math.floor(Math.random() * maxNumber) + 1;
            
            // Update UI
            currentLevelEl.textContent = level;
            maxNumberEl.textContent = maxNumber;
            remainingChancesEl.textContent = chances;
            gameMessage.textContent = `Enter a number between 1 and ${maxNumber}`;
            gameMessage.style.color = "#ffcc00";
            guessInput.value = '';
            guessInput.focus();
            
            // Set level description
            if (level <= 10) levelDescEl.textContent = 'Beginner';
            else if (level <= 20) levelDescEl.textContent = 'Easy';
            else if (level <= 30) levelDescEl.textContent = 'Medium';
            else if (level <= 40) levelDescEl.textContent = 'Hard';
            else levelDescEl.textContent = 'Expert';
            
            // Show best score
            const bestScore = getBestScore(level);
            bestScoreEl.textContent = bestScore ? `${bestScore}%` : 'N/A';
        }

        // Check the player's guess
        function checkGuess() {
            if (!gameState.gameStarted) return;
            
            const guess = parseInt(guessInput.value);
            if (isNaN(guess) || guess < 1 || guess > parseInt(maxNumberEl.textContent)) {
                gameMessage.textContent = `Please enter a valid number between 1 and ${maxNumberEl.textContent}`;
                gameMessage.style.color = "#f44336";
                return;
            }
            
            gameState.remainingChances--;
            remainingChancesEl.textContent = gameState.remainingChances;
            
            if (guess === gameState.secretNumber) {
                // Player won
                endGame(true);
            } else if (gameState.remainingChances === 0) {
                // Player lost
                endGame(false);
            } else {
                // Give hint
                if (gameState.settings.hints) {
                    gameMessage.textContent = `Your guess is too ${guess < gameState.secretNumber ? 'low' : 'high'}.`;
                    gameMessage.style.color = guess < gameState.secretNumber ? "#4a90e2" : "#ff6b6b";
                } else {
                    gameMessage.textContent = 'Try again!';
                    gameMessage.style.color = "#ffcc00";
                }
            }
            
            guessInput.value = '';
        }

        // End the game (win or lose)
        function endGame(isWin) {
            const endTime = new Date();
            const timeTaken = Math.floor((endTime - gameState.startTime) / 1000); // in seconds
            
            // Calculate accuracy (for wins only)
            let accuracy = 0;
            const maxChances = parseInt(maxNumberEl.textContent) < 500 ? 10 : 
                               parseInt(maxNumberEl.textContent) < 1000 ? 9 : 8;
            if (isWin) {
                accuracy = Math.round((maxChances - gameState.remainingChances) / maxChances * 100);
            }
            
            // Add to history
            const historyEntry = {
                level: gameState.currentLevel,
                result: isWin ? 'Win' : 'Lose',
                date: new Date().toLocaleString(),
                time: `${timeTaken} sec`,
                accuracy: isWin ? `${accuracy}%` : 'N/A',
                score: isWin ? calculateScore(timeTaken, accuracy, gameState.currentLevel) : 0
            };
            
            gameState.gameHistory.push(historyEntry);
            
            // Unlock next level if player won
            if (isWin && !gameState.unlockedLevels.includes(gameState.currentLevel + 1)) {
                gameState.unlockedLevels.push(gameState.currentLevel + 1);
            }
            
            // Save game data
            saveGameData();
            
            // Display result message
            if (isWin) {
                gameMessage.textContent = `Congratulations! You found the number in ${maxChances - gameState.remainingChances} tries.`;
                gameMessage.style.color = "#4caf50";
            } else {
                gameMessage.textContent = `Game over! The number was ${gameState.secretNumber}.`;
                gameMessage.style.color = "#f44336";
            }
            
            gameState.gameStarted = false;
        }

        // Render level selection screen
        function renderLevels() {
            levelsContainer.innerHTML = '';
            
            for (let i = 1; i <= gameState.maxLevel; i++) {
                const isUnlocked = gameState.unlockedLevels.includes(i);
                const levelCard = document.createElement('div');
                levelCard.className = `level-card ${isUnlocked ? '' : 'locked'}`;
                levelCard.innerHTML = `
                    <div class="level-number">${i}</div>
                    <div class="level-difficulty">${getLevelDifficulty(i)}</div>
                    ${isUnlocked ? '' : '<i class="fas fa-lock lock-icon"></i>'}
                `;
                
                if (isUnlocked) {
                    levelCard.addEventListener('click', () => {
                        showScreen('game');
                        startNewGame(i);
                    });
                }
                
                levelsContainer.appendChild(levelCard);
            }
        }

        // Get level difficulty description
        function getLevelDifficulty(level) {
            if (level <= 10) return 'Beginner';
            if (level <= 20) return 'Easy';
            if (level <= 30) return 'Medium';
            if (level <= 40) return 'Hard';
            return 'Expert';
        }

        // Render game history
        function renderHistory() {
            historyBody.innerHTML = '';
            
            if (gameState.gameHistory.length === 0) {
                historyBody.innerHTML = '<tr><td colspan="6" style="text-align: center;">No game history yet</td></tr>';
                return;
            }
            
            // Sort history by date (newest first)
            const sortedHistory = [...gameState.gameHistory].reverse();
            
            sortedHistory.forEach(entry => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${entry.date}</td>
                    <td>${entry.level}</td>
                    <td class="${entry.result === 'Win' ? 'win' : 'lose'}">${entry.result}</td>
                    <td>${entry.time}</td>
                    <td>${entry.accuracy}</td>
                    <td>${entry.score}</td>
                `;
                historyBody.appendChild(row);
            });
        }

        // Reset game history
        function resetHistory() {
            if (confirm('Are you sure you want to reset all game history?')) {
                gameState.gameHistory = [];
                saveGameData();
                renderHistory();
            }
        }

        // Reset all game data
        function resetAllData() {
            if (confirm('Are you sure you want to reset ALL game data? This will erase your progress, history, and settings.')) {
                // Reset game state
                gameState.unlockedLevels = [1];
                gameState.gameHistory = [];
                gameState.settings = {
                    sound: true,
                    vibration: false,
                    hints: true,
                    startLevel: 1
                };
                
                // Clear localStorage
                localStorage.removeItem('numberGuessingGame');
                
                // Reset UI
                renderLevels();
                renderHistory();
                applySettings();
                
                // Show notification
                alert('All game data has been reset! The game has been restored to its initial state.');
                
                // Go to home screen
                showScreen('home');
                navButtons.forEach(btn => {
                    btn.classList.remove('active');
                    if (btn.getAttribute('data-screen') === 'home') {
                        btn.classList.add('active');
                    }
                });
            }
        }

        // Update game settings
        function updateSetting() {
            gameState.settings.sound = soundToggle.checked;
            gameState.settings.vibration = vibrationToggle.checked;
            gameState.settings.hints = hintsToggle.checked;
            gameState.settings.startLevel = parseInt(startLevelSelect.value);
            saveGameData();
        }

        // Apply settings to UI
        function applySettings() {
            soundToggle.checked = gameState.settings.sound;
            vibrationToggle.checked = gameState.settings.vibration;
            hintsToggle.checked = gameState.settings.hints;
            startLevelSelect.value = gameState.settings.startLevel;
        }

        // Get best score for a level
        function getBestScore(level) {
            const levelHistory = gameState.gameHistory.filter(entry => 
                entry.level === level && entry.result === 'Win'
            );
            
            if (levelHistory.length === 0) return null;
            
            const bestEntry = levelHistory.reduce((best, current) => 
                current.score > best.score ? current : best
            );
            
            return bestEntry.accuracy.replace('%', '');
        }

        // Calculate score for a game
        function calculateScore(time, accuracy, level) {
            // Base score: accuracy percentage
            let score = accuracy;
            
            // Time bonus: subtract 1 point per 5 seconds
            score -= Math.floor(time / 5);
            
            // Level multiplier: higher levels give more points
            score *= (1 + level / 20);
            
            // Ensure score is at least 0
            return Math.max(0, Math.round(score));
        }

        // Initialize the game when page loads
        window.addEventListener('DOMContentLoaded', initGame);
    </script>
</body>
</html>