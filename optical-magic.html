<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Optical Illusion Experience</title>
     <link rel="stylesheet" href="css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #0f0c29, #302b63, #24243e);
            color: white;
            min-height: 100vh;
            overflow-x: hidden;
            perspective: 1000px;
            transition: background 0.5s ease;
        }

        /* Optical illusion background patterns */
        .illusion-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height极: 100%;
            z-index: -1;
            opacity: 0.15;
            background-image: 
                radial-gradient(circle at 10% 20%, rgba(255, 0, 255, 0.2) 0%, transparent 20%),
                radial-gradient(circle at 90% 80%, rgba(0, 255, 255, 0.2) 0%, transparent 20%),
                linear-gradient(45deg, rgba(255,255,255,0.05) 25%, transparent 25%, transparent 75%, rgba(255,255,255,0.05) 75%, rgba(255,255,255,0.05)),
                linear-gradient(45deg, rgba(255,255,255,0.05) 25%, transparent 25%, transparent 75%, rgba(255,255,255,0.05) 75%, rgba(255,255,255,0.05));
            background-size: 200px 200px;
            background-position: 0 0, 100px 100px;
            animation: bgMove 20s linear infinite;
        }

        @keyframes bgMove {
            0% { background-position: 0 0, 100px 100px; }
            100% { background-position: 200px 0, 300px 100px; }
        }

        .screen {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            padding: 20px;
            z-index: 10;
            overflow: auto;
        }

        .active {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        /* Scrollable screens */
        #help-screen, #archives-screen, #settings-screen, #about-screen, #result-screen {
            justify-content: flex-start;
            padding-top: 80px;
            padding-bottom: 40px;
            overflow-y: auto;
        }

        /* Age Verification Screen */
        #age-verification {
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(10px);
        }

        .age-box {
            background: linear-gradient(145deg, #1a237e, #311b92);
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            max-width: 700px;
            width: 90%;
            box-shadow: 
                0 0 50px rgba(138, 43, 226, 0.5),
                0 15px 35px rgba(0, 0, 0, 0.5);
            border: 2px solid #4a148c;
            position: relative;
            overflow: hidden;
            transform-style: preserve-3d;
        }

        .age-box::before {
            content: "";
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: conic-gradient(
                transparent, 
                rgba(168, 85, 247, 0.5),
                transparent 30%
            );
            animation: rotate 4s linear infinite;
            z-index: -1;
        }

        @keyframes rotate {
            100% { transform: rotate(360deg); }
        }

        .age-box-content {
            position: relative;
            z-index: 2;
        }

        .age-box h1 {
            font-size: 2.8rem;
            margin-bottom: 25px;
            color: #e91e63;
            text-shadow: 0 0 10px rgba(233, 30, 99, 0.7);
        }

        .age-box p {
            font-size: 1.4rem;
            margin-bottom: 20px;
            line-height: 1.6;
        }

        .warning {
            background: rgba(255, 87, 34, 0.2);
            border-left: 4px solid #ff5722;
            padding: 15px;
            margin: 20px 0;
            border-radius: 0 8px 8px 0;
            text-align: left;
            font-size: 1.2rem;
        }

        .warning i {
            color: #ff5722;
            margin-right: 10px;
        }

        .btn {
            background: linear-gradient(to right, #ff416c, #ff4b2b);
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 1.3rem;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
            box-shadow: 0 5px 15px rgba(255, 65, 108, 0.4);
            margin: 10px;
            position: relative;
            overflow: hidden;
            z-index: 1;
        }

        .btn::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(to right, #ff4b2b, #ff416c);
            z-index: -1;
            transition: transform 0.5s ease;
            transform: scaleX(0);
            transform-origin: left;
        }

        .btn:hover::before {
            transform: scale极X(1);
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(255, 65, 108, 0.6);
        }

        /* Home Screen */
        #home-screen {
            background: radial-gradient(circle, rgba(15, 23, 42, 0.8), rgba(2, 6, 23, 0.9));
        }

        .logo {
            font-size: 4rem;
            margin-bottom: 20px;
            text-align: center;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { text-shadow: 0 0 10px rgba(0, 247, 255, 0.7); }
            50% { text-shadow: 0 0 30px rgba(0, 247, 255, 1); }
            100% { text-shadow: 极0 0 10px rgba(0, 247, 255, 0.7); }
        }

        .logo i {
            color: #00f7ff;
            margin-right: 15px;
        }

        .title {
            font-size: 3.5rem;
            margin-bottom: 20px;
            text-align: center;
            color: #ffeb3b;
            text-shadow: 0 0 15px rgba(255, 235, 59, 0.6);
            background: linear-gradient(45deg, #ffeb3b, #ff9800, #ffeb3b);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: gradientShift 3s infinite alternate;
        }

        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            100% { background-position: 100% 50%; }
        }

        .subtitle {
            font-size: 1.5rem;
            margin-bottom: 40px;
            text-align: center;
            max-width: 700px;
            color: #e0f7fa;
        }

        .home-buttons {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 25px;
            max-width: 800px;
            width: 100%;
        }

        .home-btn {
            background: linear-gradient(145deg, #6a11cb, #2575fc);
            width: 220px;
            height: 220px;
            border-radius: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 20px;
            box-shadow: 
                0 10px 25px rgba(33, 150, 243, 0.4),
                inset 0 0 20px rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
            cursor: pointer;
            border: 2px solid #5d9eff;
            position: relative;
            overflow: hidden;
            transform-style: preserve-3d;
        }

        .home-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 50%;
            background: linear-gradient(rgba(255,255,255,0.2), transparent);
            border-radius: 20px 20px 0 0;
            z-index: 1;
        }

        .home-btn::after {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, 
                transparent 48%, rgba(255,255,255,0.15) 50%, 
                transparent 52%);
            background-size: 300% 300%;
            animation: shine 3s infinite;
            z-index: 1;
        }

        @keyframes shine {
            0% { background-position: -100% 0; }
            100% { background-position: 200% 0; }
        }

        .home-btn:hover {
            transform: translateY(-10px) scale(1.05) rotateY(5deg);
            box-shadow: 0 15px 35px rgba(33, 150, 243, 0.6);
        }

        .home-btn i {
            font-size: 4.5rem;
            margin-bottom: 20px;
            color: #80deea;
            z-index: 2;
            text-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }

        .home-btn span {
            font-size: 1.8rem;
            font-weight: bold;
            z-index: 2;
            text-shadow: 0 2px 8px rgba(0,0,0,0.4);
        }

        /* Category Screen */
        .category-container {
            max-width: 1100px;
            width: 100%;
        }

        .category-title {
            font-size: 2.8rem;
            margin-bottom: 40px;
            text-align: center;
            color: #ff9800;
            text-shadow: 0 0 15px rgba(255, 152, 0, 0.6);
            background: linear-gradient(45deg, #ff9800, #ff5722, #ff9800);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: gradientShift 3s infinite alternate;
        }

        .category-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 30px;
            width: 100%;
        }

        .category-card {
            background: linear-gradient(145deg, #7b1fa2, #4a148c);
            border-radius: 20px;
            padding: 30px 20px;
            text-align: center;
            box-shadow: 
                0 10px 25px rgba(123, 31, 162, 0.4),
                inset 0 0 15px rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
            cursor: pointer;
            border: 2px solid #ba68c8;
            position: relative;
            overflow: hidden;
            transform-style: preserve-3d;
        }

        .category-card:hover {
            transform: translateY(-10px) rotateX(5deg);
            box-shadow: 0 15px 35px rgba(123, 31, 162, 0.6);
        }

        .category-card i {
            font-size: 4rem;
            margin-bottom: 20px;
            color: #f48fb1;
        }

        .category-card h3 {
            font-size: 2rem;
            margin-bottom: 15px;
        }

        .category-card p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        /* Level Screen */
        .level-container {
            max-width: 900px;
            width: 100%;
        }

        .level-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 25px;
            width: 100%;
        }

        .level-card {
            background: linear-gradient(145deg, #009688, #00695c);
            border-radius: 15px;
            padding: 25px 15px;
            text-align: center;
            box-shadow: 
                0 8px 20px rgba(0, 150, 136, 0.4),
                inset 0 0 10px rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
            cursor: pointer;
            border: 2px solid #4db6ac;
            position: relative;
            overflow: hidden;
            transform-style: preserve-3d;
        }

        .level-card:hover {
            transform: translateY(-8px) rotateY(5deg);
            box-shadow: 0 12px 30px rgba(0, 150, 136, 0.6);
        }

        .level-card.locked {
            background: linear-gradient(145deg, #455a64, #263238);
            cursor: not-allowed;
            opacity: 0.7;
        }

        .level-card.locked::after {
            content: "\f023";
            font-family: "Font Awesome 5 Free";
            font-weight: 900;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 3rem;
            color: rgba(255, 255, 255, 0.7);
            z-index: 2;
        }

        .level-card.completed::before {
            content: "\f00c";
            font-family: "Font Awesome 5 Free";
            font-weight: 900;
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(76, 175, 80, 0.8);
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            z-index: 3;
        }

        .level-card i {
            font-size: 3.5rem;
            margin-bottom: 15px;
            color: #80cbc4;
            z-index: 2;
        }

        .level-card h3 {
            font-size: 1.8rem;
            margin-bottom: 10px;
            z-index: 2;
        }

        /* Video Screen */
        #video-screen {
            background: black;
        }

        #video-container {
            width: 100%;
            height: 100%;
            background: black;
            position: relative;
        }

        #illusion-video {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        .fullscreen-btn {
            position: absolute;
            bottom: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.5);
            color: white;
            border: none;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            font-size: 1.5rem;
            cursor: pointer;
            z-index: 20;
            display: flex;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(5px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
        }

        .fullscreen-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(1.1);
        }

        .skip-btn {
            position: absolute;
            bottom: 20px;
            left: 20px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: none;
            padding: 10px 20px;
            font-size: 1rem;
            border-radius: 50px;
            cursor: pointer;
            z-index: 20;
            backdrop-filter: blur(5px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
        }

        .skip-btn:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        /* Result Screen */
        .result-container {
            background: linear-gradient(145deg, #5e35b1, #4527a0);
            padding: 40px;
            border-radius: 20px;
            max-width: 700px;
            width: 90%;
            box-shadow: 
                0 15px 35px rgba(94, 53, 177, 0.5),
                inset 0 0 20px rgba(255, 255, 255, 0.1);
            text-align: center;
            position: relative;
            overflow: hidden;
            max-height: 80vh;
            overflow-y: auto;
        }

        .result-container::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                linear-gradient(45deg, transparent 48%, rgba(255,255,255,0.05) 50%, transparent 52%),
                linear-gradient(-45deg, transparent 48%, rgba(255,255,255,0.05) 50%, transparent 52%);
            background-size: 100px 100px;
            opacity: 0.3;
            animation: gridMove 20s linear infinite;
            z-index: -1;
        }

        @keyframes gridMove {
            0% { background-position: 0 0; }
            100% { background-position: 100px 100px; }
        }

        .result-title {
            font-size: 2.5rem;
            margin-bottom: 30px;
            color: #e1bee7;
            text-shadow: 0 0 10px rgba(225, 190, 231, 0.5);
        }

        .experience-box {
            width: 100%;
            margin: 25px 0;
        }

        .experience-box label {
            display: block;
            font-size: 1.4rem;
            margin-bottom: 15px;
            text-align: left;
            color: #d1c4e9;
        }

        #user-experience {
            width: 100%;
            height: 150px;
            padding: 15px;
            font-size: 1.2rem;
            border-radius: 10px;
            border: 2px solid #7e57c2;
            background: rgba(0, 0, 0, 0.3);
            color: white;
            resize: none;
            transition: all 0.3s ease;
        }

        #user-experience:focus {
            border-color: #b388ff;
            box-shadow: 0 0 10px rgba(179, 136, 255, 0.5);
            outline: none;
        }

        .rating-container {
            display: flex;
            justify-content: center;
            margin: 20px 0;
        }

        .rating-star {
            font-size: 2.5rem;
            color: #ccc;
            cursor: pointer;
            transition: color 0.2s;
            margin: 0 5px;
        }

        .rating-star:hover,
        .rating-star.active {
            color: #ffeb3b;
        }

        .result-buttons {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 20px;
            margin-top: 30px;
        }

        /* Navigation */
        .back-btn {
            position: fixed;
            top: 20px;
            left: 20px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: none;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            font-size: 1.5rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 100;
            backdrop-filter: blur(5px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
        }

        .back-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(1.1);
        }
        
        /* Reset All Button */
        .reset-all-btn {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: none;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            font-size: 1.2rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 100;
            backdrop-filter: blur(5px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
        }

        .reset-all-btn:hover {
            background: rgba(255, 0, 0, 0.3);
            transform: scale(1.1);
        }

        /* Settings Screen */
        .settings-container {
            background: linear-gradient(145deg, #1a237e, #0d47a1);
            padding: 40px;
            border-radius: 20px;
            max-width: 700px;
            width: 90%;
            box-shadow: 
                0 15px 35px rgba(26, 35, 126, 0.5),
                inset 0 0 20px rgba(255, 255, 255, 0.1);
            text-align: center;
        }

        .settings-title {
            font-size: 2.5rem;
            margin-bottom: 30px;
            color: #80deea;
        }

        .settings-section {
            margin-bottom: 30px;
            text-align: left;
        }

        .settings-section h3 {
            font-size: 1.5rem;
            margin-bottom: 15px;
            color: #bb86fc;
            border-bottom: 2px solid #3700b3;
            padding-bottom: 5px;
        }

        .settings-option {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
            margin: 15px 0;
        }

        .settings-option label {
            font-size: 1.3rem;
            flex: 1;
            text-align: left;
        }

        .switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 34px;
        }

        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 34px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 26px;
            width: 26px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .slider {
            background: linear-gradient(to right, #00c853, #64dd17);
        }

        input:checked + .slider:before {
            transform: translateX(26px);
        }

        .slider-container {
            display: flex;
            align-items: center;
            gap: 15px;
            margin: 10px 0;
        }

        .slider-container label {
            min-width: 120px;
            font-size: 1.1rem;
        }

        .slider-container input[type="range"] {
            flex: 1;
            height: 10px;
            border-radius: 5px;
            background: rgba(255, 255, 255, 0.1);
            outline: none;
        }

        .theme-selector {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 10px;
            flex-wrap: wrap;
        }

        .theme-option {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            border: 2px solid transparent;
            transition: all 0.3s ease;
        }

        .theme-option.active {
            border: 2px solid white;
            transform: scale(1.1);
        }

        .theme-purple { background: linear-gradient(135deg, #0f0c29, #302b63); }
        .theme-blue { background: linear-gradient(135deg, #0f1b31, #1a2980); }
        .theme-red { background: linear-gradient(135deg, #2c0f29, #b21f1f); }
        .theme-green { background: linear-gradient(135deg, #0d2929, #1f6b1f); }
        .theme-dark { background: linear-gradient(135deg, #121212, #333); }
        .theme-rainbow { background: linear-gradient(135deg, #ff0000, #ff9900, #ffff00, #00ff00, #00ffff, #0000ff, #9900ff); }

        /* Help Screen */
        .help-container {
            background: linear-gradient(145deg, #1a237e, #0d47a1);
            padding: 40px;
            border-radius: 20px;
            max-width: 800px;
            width: 90%;
            box-shadow: 
                0 15px 35px rgba(26, 35, 126, 0.5),
                inset 0 0 20px rgba(255, 255, 255, 0.1);
            text-align: left;
            max-height: 80vh;
            overflow-y: auto;
        }

        .help-title {
            font-size: 2.5rem;
            margin-bottom: 30px;
            color: #80deea;
            text-align: center;
        }

        .help-section {
            margin-bottom: 30px;
        }

        .help-section h3 {
            font-size: 1.8rem;
            margin-bottom: 15px;
            color: #bb86fc;
        }

        .help-section p {
            font-size: 1.2rem;
            line-height: 1.6;
            margin-bottom: 15px;
        }

        .help-section ul {
            padding-left: 30px;
            margin-bottom: 15px;
        }

        .help-section li {
            font-size: 1.1rem;
            margin-bottom: 8px;
            line-height: 1.5;
        }

        /* Animations */
        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-20px); }
            100% { transform: translateY(0px); }
        }

        .floating {
            animation: float 4s ease-in-out infinite;
        }

        /* Progress Bar */
        .progress-container {
            width: 100%;
            max-width: 500px;
            margin: 20px 0;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            overflow: hidden;
            position: relative;
        }

        .progress-bar {
            height: 20px;
            background: linear-gradient(90deg, #00c853, #64dd17);
            border-radius: 10px;
            transition: width 0.5s ease;
            box-shadow: 0 0 8px rgba(0, 200, 83, 0.5);
        }

        .progress-text {
            text-align: center;
            font-size: 1.2rem;
            margin-top: 10px;
            color: #d1c4e9;
        }

        /* Level Info */
        .level-info {
            background: rgba(0, 0, 0, 0.3);
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: center;
        }

        .level-info h3 {
            color: #80cbc4;
            margin-bottom: 10px;
        }

        /* Unlock Animation */
        @keyframes unlock {
            0% { transform: scale(0.5); opacity: 0; }
            70% { transform: scale(1.1); opacity: 1; }
            100% { transform: scale(1); opacity: 1; }
        }

        .unlocking {
            animation: unlock 0.5s ease-out forwards;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .home-btn {
                width: 160px;
                height: 160px;
            }
            
            .home-btn i {
                font-size: 3.5rem;
            }
            
            .home-btn span {
                font-size: 1.5rem;
            }
            
            .title {
                font-size: 2.5rem;
            }
            
            .subtitle {
                font-size: 1.2rem;
            }

            .category-card {
                padding: 20px 15px;
            }

            .category-card i {
                font-size: 3rem;
            }

            .category-card h3 {
                font-size: 1.7rem;
            }
            
            .result-container, .settings-container, .help-container {
                padding: 25px;
            }
        }

        @media (max-width: 480px) {
            .age-box {
                padding: 25px;
            }
            
            .age-box h1 {
                font-size: 2rem;
            }
            
            .age-box p {
                font-size: 1.1rem;
            }
            
            .btn {
                padding: 12px 30px;
                font-size: 1.1rem;
            }
            
            .home-buttons {
                gap: 15px;
            }
            
            .home-btn {
                width: 130px;
                height: 130px;
            }
            
            .home-btn i {
                font-size: 2.8rem;
            }
            
            .home-btn span {
                font-size: 1.2rem;
            }

            .title {
                font-size: 2rem;
            }

            .subtitle {
                font-size: 1rem;
                margin-bottom: 30px;
            }
            
            .category-title, .result-title, .settings-title, .help-title {
                font-size: 2rem;
            }
        }
    </style>
</head>
<body>
    <div class="illusion-bg"></div>
    
    <!-- Age Verification Screen -->
    <div id="age-verification" class="screen active">
        <div class="age-box floating">
            <div class="age-box-content">
                <h1><i class="fas fa-exclamation-triangle"></i> AGE VERIFICATION</h1>
                <p>You must be 15 years or older to access this optical illusion experience. By clicking OK, you confirm that you meet the age requirement.</p>
                
                <div class="warning">
                    <i class="fas fa-exclamation-circle"></i>
                    <strong>Important:</strong> Some illusions may cause dizziness or discomfort for people with photosensitive epilepsy or visual impairments. Discontinue use if you experience any discomfort.
                </div>
                
                <button id="age-confirm-btn" class="btn">OK, I'm 15 or older</button>
            </div>
        </div>
    </div>

    <!-- Home Screen -->
    <div id="home-screen" class="screen">
        <button class="back-btn" onclick="showScreen('home-screen')"><i class="fas fa-home"></i></button>
        <button class="reset-all-btn" onclick="resetAll()" title="Reset All Data">
            <i class="fas fa-undo"></i>
        </button>
        
        <div class="logo">
            <i class="fas fa-eye"></i>
        </div>
        
        <h1 class="title">OPTICAL ILLUSION EXPERIENCE</h1>
        <p class="subtitle">Explore mind-bending illusions that challenge your perception of reality. Select an option below to begin your journey.</p>
        
        <div class="progress-container">
            <div class="progress-bar" id="global-progress" style="width: 0%"></div>
            <div class="progress-text">Total Progress: <span id="progress-percent">0%</span></div>
        </div>
        
        <div class="home-buttons">
            <div class="home-btn" onclick="showScreen('category-screen')">
                <i class="fas fa-play-circle"></i>
                <span>START</span>
            </div>
            <div class="home-btn" onclick="showScreen('help-screen')">
                <i class="fas fa-question-circle"></i>
                <span>HELP</span>
            </div>
            <div class="home-btn" onclick="showScreen('archives-screen')">
                <i class="fas fa-archive"></i>
                <span>ARCHIVES</span>
            </div>
            <div class="home-btn" onclick="showScreen('settings-screen')">
                <i class="fas fa-cog"></i>
                <span>SETTINGS</span>
            </div>
            <div class="home-btn" onclick="showScreen('about-screen')">
                <i class="fas fa-info-circle"></i>
                <span>ABOUT</span>
            </div>
        </div>
    </div>

    <!-- Category Selection Screen -->
    <div id="category-screen" class="screen">
        <button class="back-btn" onclick="showScreen('home-screen')"><i class="fas fa-arrow-left"></i></button>
        
        <div class="category-container">
            <h2 class="category-title">SELECT AN ILLUSION TYPE</h2>
            
            <div class="category-grid">
                <div class="category-card" onclick="showLevelScreen('sleepy')">
                    <i class="fas fa-bed"></i>
                    <h3>SLEEPY ILLUSION</h3>
                    <p>Experience illusions that create a hypnotic, sleep-inducing effect</p>
                </div>
                
                <div class="category-card" onclick="showLevelScreen('hypnotize')">
                    <i class="fas fa-bullseye"></i>
                    <h3>OPTICAL HYPNOTIZE</h3>
                    <p>Mesmerizing patterns that can put you in a trance-like state</p>
                </div>
                
                <div class="category-card" onclick="showLevelScreen('color')">
                    <i class="fas fa-fill-drip"></i>
                    <h3>COLOR FILL ILLUSION</h3>
                    <p>Watch colors transform and blend in unexpected ways</p>
                </div>
                
                <div class="category-card" onclick="showLevelScreen('image')">
                    <i class="fas fa-images"></i>
                    <h3>IMAGE MIX ILLUSION</h3>
                    <p>Images that morph and combine to trick your visual perception</p>
                </div>
                
                <div class="category-card" onclick="showLevelScreen('horror')">
                    <i class="fas fa-ghost"></i>
                    <h3>HORROR ATTACK</h3>
                    <p>Intense illusions designed to provoke a startling response</p>
                </div>
            </div>
        </div>
    </div>


    <!-- Level Selection Screen -->
    <div id="level-screen" class="screen">
        <button class="back-btn" onclick="showScreen('category-screen')"><i class="fas fa-arrow-left"></i></button>
        
        <div class="level-container">
            <h2 class="category-title" id="level-title">SELECT A LEVEL</h2>
            
            <div class="level-info">
                <h3>Progress in <span id="current-category-name">Category</span></h3>
                <div class="progress-container">
                    <div class="progress-bar" id="category-progress" style="width: 0%"></div>
                    <div class="progress-text">Levels Completed: <span id="category-progress-text">0/0</span></div>
                </div>
            </div>
            
            <div class="level-grid" id="level-grid">
                <!-- Levels will be dynamically added here -->
            </div>
        </div>
    </div>

    <!-- Video Player Screen -->
    <div id="video-screen" class="screen">
        <div id="video-container">
            <video id="illusion-video" autoplay></video>
            <button class="fullscreen-btn" onclick="toggleFullscreen()">
                <i class="fas fa-expand"></i>
            </button>
            <button class="skip-btn" onclick="showScreen('result-screen')">
                <i class="fas fa-forward"></i> Skip Video
            </button>
        </div>
    </div>

    <!-- Result Screen -->
    <div id="result-screen" class="screen">
        <div class="result-container">
            <h2 class="result-title">YOUR ILLUSION EXPERIENCE</h2>
            
            <p>We hope you enjoyed the illusion! Please share your experience below.</p>
            
            <div class="rating-container">
                <i class="fas fa-star rating-star" data-value="1"></i>
                <i class="fas fa-star rating-star" data-value="2"></i>
                <i class="fas fa-star rating-star" data-value="3"></i>
                <i class="fas fa-star rating-star" data-value="4"></i>
                <i class="fas fa-star rating-star" data-value="5"></i>
            </div>
            
            <div class="experience-box">
                <label for="user-experience">Describe what you saw and felt:</label>
                <textarea id="user-experience" placeholder="The illusion made me feel... I saw..."></textarea>
            </div>
            
            <div class="result-buttons">
                <button class="btn" onclick="playAgain()">PLAY AGAIN</button>
                <button class="btn" onclick="playNextLevel()">PLAY NEXT LEVEL</button>
                <button class="btn" onclick="goToHome()">GO TO HOME</button>
            </div>
        </div>
    </div>

    <!-- Help Screen -->
    <div id="help-screen" class="screen">
        <button class="back-btn" onclick="showScreen('home-screen')"><i class="fas fa-arrow-left"></i></button>
        
        <div class="help-container">
            <h2 class="help-title">OPTICAL ILLUSION HELP GUIDE</h2>
            
            <div class="help-section">
                <h3>Getting Started</h3>
                <p>Welcome to the Optical Illusion Experience! Follow these steps to begin your journey:</p>
                <ul>
                    <li>Complete the age verification on the first screen</li>
                    <li>Select a category from the home screen</li>
                    <li>Choose a level to experience the illusion</li>
                    <li>After watching, rate the illusion and share your experience</li>
                    <li>Save your experience to view it later in Archives</li>
                </ul>
            </div>
            
            <div class="help-section">
                <h3>Level Progression System</h3>
                <p>Our advanced level system ensures a structured experience:</p>
                <ul>
                    <li><strong>Unlock System:</strong> Complete each level to unlock the next one in the category</li>
                    <li><strong>Progress Tracking:</strong> Your completion status is saved automatically</li>
                    <li><strong>Visual Indicators:</strong> Completed levels are marked with a checkmark</li>
                    <li><strong>Category Progress:</strong> See your overall progress in each category</li>
                    <li><strong>Global Progress:</strong> Track your total completion across all categories</li>
                </ul>
            </div>
            
            <div class="help-section">
                <h3>Categories Explained</h3>
                <p>We offer five different types of optical illusions:</p>
                <ul>
                    <li><strong>Sleepy Illusion:</strong> Relaxing patterns that may induce a meditative state</li>
                    <li><strong>Optical Hypnotize:</strong> Mesmerizing spirals that draw you into a trance</li>
                    <li><strong>Color Fill Illusion:</strong> Color transformations that challenge your perception</li>
                    <li><strong>Image Mix Illusion:</strong> Images that blend and morph in unexpected ways</li>
                    <li><strong>Horror Attack:</strong> Intense illusions that provoke a startling response</li>
                </ul>
            </div>
            
            <div class="help-section">
                <h3>Level Progression</h3>
                <p>Each category has multiple levels with increasing intensity:</p>
                <ul>
                    <li>Start with Level 1 in any category</li>
                    <li>Complete Level 1 to unlock Level 2</li>
                    <li>Progress through levels to unlock more complex illusions</li>
                    <li>Your progress is saved automatically</li>
                </ul>
            </div>
            
            <div class="help-section">
                <h3>Safety Information</h3>
                <p>For your safety and comfort:</p>
                <ul>
                    <li>Discontinue use if you feel dizzy or uncomfortable</li>
                    <li>Take breaks between illusions</li>
                    <li>Use in a well-lit environment</li>
                    <li>Not recommended for people with epilepsy or photosensitivity</li>
                    <li>View from a comfortable distance</li>
                </ul>
            </div>
            
            <div class="help-section">
                <h3>Troubleshooting</h3>
                <p>If you encounter issues:</p>
                <ul>
                    <li><strong>Videos not playing:</strong> Ensure your browser supports HTML5 video</li>
                    <li><strong>Screen not loading:</strong> Refresh the page or clear browser cache</li>
                    <li><strong>Fullscreen not working:</strong> Try clicking the page before activating fullscreen</li>
                    <li><strong>Progress not saving:</strong> Check browser settings for localStorage permissions</li>
                </ul>
            </div>
            
            <button class="btn" onclick="showScreen('home-screen')" style="margin-top: 20px; width: 100%;">BACK TO HOME</button>
        </div>
    </div>

    <!-- Archives Screen -->
    <div id="archives-screen" class="screen">
        <button class="back-btn" onclick="showScreen('home-screen')"><i class="fas fa-arrow-left"></i></button>
        
        <div class="result-container">
            <h2 class="result-title">YOUR ILLUSION ARCHIVES</h2>
            
            <div class="experience-box">
                <div style="background: rgba(0,0,0,0.3); padding: 20px; border-radius: 10px; text-align: left; max-height: 400px; overflow-y: auto;">
                    <h3 style="color: #e1bee7; margin-bottom: 15px;">Saved Experiences:</h3>
                    <ul id="archives-list" style="list-style: none;">
                        <!-- Saved experiences will be loaded here -->
                    </ul>
                </div>
            </div>
            
            <div class="result-buttons">
                <button class="btn" onclick="clearArchives()" style="background: linear-gradient(to right, #f44336, #d32f2f);">
                    <i class="fas fa-trash"></i> CLEAR ARCHIVES
                </button>
                <button class="btn" onclick="exportArchives()" style="background: linear-gradient(to right, #4caf50, #2e7d32);">
                    <i class="fas fa-download"></i> EXPORT
                </button>
                <button class="btn" onclick="showScreen('home-screen')">BACK TO HOME</button>
            </div>
        </div>
    </div>

    <!-- Settings Screen -->
    <div id="settings-screen" class="screen">
        <button class="back-btn" onclick="showScreen('home-screen')"><i class="fas fa-arrow-left"></i></button>
        
        <div class="settings-container">
            <h2 class="settings-title">APPLICATION SETTINGS</h2>
            
            <div class="settings-section">
                <h3>General Settings</h3>
                <div class="settings-option">
                    <label>Enable Sound Effects</label>
                    <label class="switch">
                        <input type="checkbox" id="sound-toggle" checked>
                        <span class="slider"></span>
                    </label>
                </div>
                <div class="settings-option">
                    <label>Background Animations</label>
                    <label class="switch">
                        <input type="checkbox" id="animations-toggle" checked>
                        <span class="slider"></span>
                    </label>
                </div>
                <div class="settings-option">
                    <label>Reduce Motion Effects</label>
                    <label class="switch">
                        <input type="checkbox" id="motion-toggle">
                        <span class="slider"></span>
                    </label>
                </div>
                <div class="settings-option">
                    <label>Auto-save Experiences</label>
                    <label class="switch">
                        <input type="checkbox" id="autosave-toggle" checked>
                        <span class="slider"></span>
                    </label>
                </div>
            </div>
            
            <div class="settings-section">
                <h3>Display Settings</h3>
                <div class="slider-container">
                    <label>Brightness:</label>
                    <input type="range" id="brightness-slider" min="50" max="150" value="100">
                </div>
                <div class="slider-container">
                    <label>Contrast:</label>
                    <input type="range" id="contrast-slider" min="50" max="150" value="100">
                </div>
                <div class="slider-container">
                    <label>Saturation:</label>
                    <input type="range" id="saturation-slider" min="50" max="150" value="100">
                </div>
            </div>
            
            <div class="settings-section">
                <h3>Theme Selection</h3>
                <div class="theme-selector">
                    <div class="theme-option theme-purple active" data-theme="purple" onclick="changeTheme('purple')"></div>
                    <div class="theme-option theme-blue" data-theme="blue" onclick="changeTheme('blue')"></div>
                    <div class="theme-option theme-red" data-theme="red" onclick="changeTheme('red')"></div>
                    <div class="theme-option theme-green" data-theme="green" onclick="changeTheme('green')"></div>
                    <div class="theme-option theme-dark" data-theme="dark" onclick="changeTheme('dark')"></div>
                    <div class="theme-option theme-rainbow" data-theme="rainbow" onclick="changeTheme('rainbow')"></div>
                </div>
            </div>
            
            <div class="settings-section">
                <h3>Advanced Settings</h3>
                <div class="settings-option">
                    <label>Enable Developer Mode</label>
                    <label class="switch">
                        <input type="checkbox" id="devmode-toggle">
                        <span class="slider"></span>
                    </label>
                </div>
                <div class="settings-option">
                    <label>Reset All Progress</label>
                    <button class="btn" onclick="resetProgress()" style="padding: 8px 15px; font-size: 1rem;">Reset</button>
                </div>
            </div>
            
            <button class="btn" onclick="saveSettings()" style="margin-top: 30px; width: 100%;">SAVE SETTINGS</button>
        </div>
    </div>

    <!-- About Screen -->
    <div id="about-screen" class="screen">
        <button class="back-btn" onclick="showScreen('home-screen')"><i class="fas fa-arrow-left"></i></button>
        
        <div class="result-container">
            <h2 class="result-title">ABOUT OPTICAL ILLUSION EXPERIENCE</h2>
            
            <div class="experience-box">
                <p style="text-align: center; margin: 20px 0; font-size: 1.2rem; line-height: 1.8;">
                    This application was created to explore the fascinating world of optical illusions. 
                    Our mission is to challenge your perception and provide an immersive experience 
                    that demonstrates how easily our brains can be tricked by visual information.
                </p>
                
                <div style="background: rgba(0,0,0,0.3); padding: 20px; border-radius: 10px; margin-top: 20px;">
                    <h3 style="color: #e1bee7; margin-bottom: 15px; text-align: center;">Version Information</h3>
                    <p style="margin-bottom: 10px;"><strong>Version:</strong> 2.0.1</p>
                    <p style="margin-bottom: 10px;"><strong>Release Date:</strong> Augurt 07, 2025</p>
                    <p style="margin-bottom: 10px;"><strong>Developed By:</strong> Abdullah Asif</p>
                    <p style="margin-bottom: 10px;"><strong>Contact:</strong> https://www.aa_gamerz_official/youtube.com</p>
                </div>
                
                <h3 style="color: #e1bee7; margin: 25px 0 15px; text-align: center;">Acknowledgements</h3>
                <p style="text-align: center; line-height: 1.6;">
                    This application uses open-source libraries and resources. Special thanks to:<br>
                    Font Awesome, Google Fonts, and the optical illusion research community.
                </p>
                
                <h3 style="color: #e1bee7; margin: 25px 0 15px; text-align: center;">How Optical Illusions Work</h3>
                <p style="line-height: 1.6;">
                    Optical illusions occur because our brains try to interpret what we see and make sense of the world around us. 
                    They exploit the way our visual system processes information. Here are some common types:
                </p>
                <ul style="padding-left: 30px; margin-top: 10px;">
                    <li><strong>Literal Illusions:</strong> Create images different from the objects that make them</li>
                    <li><strong>Physiological Illusions:</strong> Result from excessive stimulation of the eyes or brain</li>
                    <li><strong>Cognitive Illusions:</strong> Where the eye and brain make unconscious inferences</li>
                </ul>
                
                <h3 style="color: #e1bee7; margin: 25px 0 15px; text-align: center;">The Science Behind Perception</h3>
                <p style="line-height: 1.6;">
                    Our visual system doesn't work like a camera. Instead, the brain constructs a model of the world from:
                </p>
                <ul style="padding-left: 30px; margin-top: 10px;">
                    <li>Pattern recognition</li>
                    <li>Previous experiences</li>
                    <li>Environmental context</li>
                    <li>Cultural influences</li>
                </ul>
                <p style="line-height: 1.6; margin-top: 10px;">
                    Optical illusions reveal the complex processes our brains use to interpret visual information. 
                    They show that perception is an active construction, not a passive recording of reality.
                </p>
            </div>
            
            <button class="btn" onclick="showScreen('home-screen')">BACK TO HOME</button>
        </div>
    </div>

    <script>
        // Current state variables
        let currentCategory = '';
        let currentLevel = 0;
        let userExperiences = [];
        let currentRating = 0;
        let userProgress = {};
        
        // Video file mapping - using relative paths
        const videoFiles = {
            sleepy: ['sleep_illusion.mp4'],
            hypnotize: ['hypnotize_1.mp4', 'hypnotize_2.mp4', 'hypnotize_3.mp4', 'hypnotize_4.mp4', 'hypnotize_5.mp4'],
            color: ['color_1.mp4', 'color_2.mp4', 'color_3.mp4', 'color_4.mp4', 'color_5.mp4'],
            image: ['img_1.mp4', 'img_2.mp4'],
            horror: ['horror_1.mp4', 'horror_2.mp4', 'horror_3.mp4']
        };
        
        // Category titles
        const categoryTitles = {
            sleepy: 'SLEEPY ILLUSION',
            hypnotize: 'OPTICAL HYPNOTIZE',
            color: 'COLOR FILL ILLUSION',
            image: 'IMAGE MIX ILLUSION',
            horror: 'HORROR ATTACK'
        };
        
        // Icon mapping
        const levelIcons = {
            sleepy: 'fas fa-bed',
            hypnotize: 'fas fa-hypnosis',
            color: 'fas fa-fill-drip',
            image: 'fas fa-images',
            horror: 'fas fa-ghost'
        };
        
        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            // Load saved experiences
            loadExperiences();
            
            // Load user progress
            loadProgress();
            
            // Update progress display
            updateGlobalProgress();
            
            // Video ended event
            const video = document.getElementById('illusion-video');
            video.addEventListener('ended', function() {
                markLevelCompleted();
                showScreen('result-screen');
            });
            
            // Load settings
            loadSettings();
            
            // Setup rating stars
            setupRatingStars();
            
            // Fix age verification button
            document.getElementById('age-confirm-btn').addEventListener('click', function() {
                showScreen('home-screen');
            });
        });
        
        // Set up rating stars
        function setupRatingStars() {
            const stars = document.querySelectorAll('.rating-star');
            stars.forEach(star => {
                star.addEventListener('click', function() {
                    const value = parseInt(this.getAttribute('data-value'));
                    currentRating = value;
                    
                    // Update star display
                    stars.forEach((s, i) => {
                        if (i < value) {
                            s.classList.add('active');
                        } else {
                            s.classList.remove('active');
                        }
                    });
                });
            });
        }
        
        // Show a specific screen
        function showScreen(screenId) {
            // Hide all screens
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active');
            });
            
            // Show the requested screen
            document.getElementById(screenId).classList.add('active');
            
            // Special cases
            if (screenId === 'video-screen') {
                playCurrentVideo();
            } else if (screenId === 'archives-screen') {
                displayExperiences();
            } else if (screenId === 'result-screen') {
                // Reset rating when showing result screen
                currentRating = 0;
                document.querySelectorAll('.rating-star').forEach(star => {
                    star.classList.remove('active');
                });
                
                // Auto-save experience
                autoSaveExperience();
            } else if (screenId === 'home-screen') {
                updateGlobalProgress();
            }
        }
        
        // Show level selection for a category
        function showLevelScreen(category) {
            currentCategory = category;
            document.getElementById('level-title').textContent = categoryTitles[category] + ' - SELECT LEVEL';
            document.getElementById('current-category-name').textContent = categoryTitles[category];
            
            const levelGrid = document.getElementById('level-grid');
            levelGrid.innerHTML = '';
            
            const levels = videoFiles[category];
            for (let i = 0; i < levels.length; i++) {
                const levelCard = document.createElement('div');
                levelCard.className = 'level-card';
                
                // Check if level is completed
                const isCompleted = isLevelCompleted(category, i);
                if (isCompleted) {
                    levelCard.classList.add('completed');
                }
                
                levelCard.innerHTML = `
                    <i class="${levelIcons[category]}"></i>
                    <h3>LEVEL ${i+1}</h3>
                `;
                
                // Check if level is unlocked
                if (i === 0 || isLevelCompleted(category, i-1)) {
                    levelCard.addEventListener('click', function() {
                        currentLevel = i;
                        showScreen('video-screen');
                    });
                } else {
                    levelCard.classList.add('locked');
                    levelCard.onclick = null;
                }
                
                levelGrid.appendChild(levelCard);
            }
            
            // Update category progress
            updateCategoryProgress(category);
            
            showScreen('level-screen');
        }
        
        // Play the current selected video
        function playCurrentVideo() {
            const video = document.getElementById('illusion-video');
            video.src = videoFiles[currentCategory][currentLevel];
            video.play().catch(e => {
                console.error("Video play failed:", e);
                alert("Error playing video. Please check your video files and try again.");
                showScreen('result-screen');
            });
        }
        
        // Toggle fullscreen mode
        function toggleFullscreen() {
            const container = document.getElementById('video-container');
            
            if (!document.fullscreenElement) {
                if (container.requestFullscreen) {
                    container.requestFullscreen();
                } else if (container.mozRequestFullScreen) {
                    container.mozRequestFullScreen();
                } else if (container.webkitRequestFullscreen) {
                    container.webkitRequestFullscreen();
                } else if (container.msRequestFullscreen) {
                    container.msRequestFullscreen();
                }
            } else {
                if (document.exitFullscreen) {
                    document.exitFullscreen();
                } else if (document.mozCancelFullScreen) {
                    document.mozCancelFullScreen();
                } else if (document.webkitExitFullscreen) {
                    document.webkitExitFullscreen();
                } else if (document.msExitFullscreen) {
                    document.msExitFullscreen();
                }
            }
        }
        
        // Mark current level as completed
        function markLevelCompleted() {
            if (!userProgress[currentCategory]) {
                userProgress[currentCategory] = {};
            }
            
            // Mark level as completed
            userProgress[currentCategory][currentLevel] = true;
            saveProgress();
            
            // Visual feedback
            const levelCards = document.querySelectorAll('.level-card');
            if (levelCards[currentLevel]) {
                levelCards[currentLevel].classList.add('completed');
            }
            
            // Unlock next level if it exists
            if (currentLevel < videoFiles[currentCategory].length - 1) {
                const nextLevel = currentLevel + 1;
                userProgress[currentCategory][nextLevel] = userProgress[currentCategory][nextLevel] || false;
                
                if (levelCards[nextLevel]) {
                    levelCards[nextLevel].classList.remove('locked');
                    levelCards[nextLevel].addEventListener('click', function() {
                        currentLevel = nextLevel;
                        showScreen('video-screen');
                    });
                    
                    // Add unlock animation
                    levelCards[nextLevel].classList.add('unlocking');
                    setTimeout(() => {
                        levelCards[nextLevel].classList.remove('unlocking');
                    }, 500);
                }
            }
            
            saveProgress();
        }
        
        // Auto-save user experience
        function autoSaveExperience() {
            const experienceText = document.getElementById('user-experience').value.trim();
            
            // Create experience object
            const experience = {
                category: currentCategory,
                level: currentLevel + 1,
                text: experienceText,
                rating: currentRating,
                date: new Date().toLocaleString()
            };
            
            // Add to experiences
            userExperiences.push(experience);
            
            // Save to localStorage
            localStorage.setItem('illusionExperiences', JSON.stringify(userExperiences));
        }
        
        // Load experiences from localStorage
        function loadExperiences() {
            const saved = localStorage.getItem('illusionExperiences');
            if (saved) {
                try {
                    userExperiences = JSON.parse(saved);
                } catch (e) {
                    console.error("Error loading experiences:", e);
                    userExperiences = [];
                }
            }
        }
        
        // Load progress from localStorage
        function loadProgress() {
            const saved = localStorage.getItem('illusionProgress');
            if (saved) {
                try {
                    userProgress = JSON.parse(saved);
                } catch (e) {
                    console.error("Error loading progress:", e);
                    userProgress = {};
                }
            } else {
                userProgress = {};
            }
        }
        
        // Save progress to localStorage
        function saveProgress() {
            localStorage.setItem('illusionProgress', JSON.stringify(userProgress));
            updateGlobalProgress();
        }
        
        // Check if a level is completed
        function isLevelCompleted(category, level) {
            return userProgress[category] && userProgress[category][level] === true;
        }
        
        // Update category progress display
        function updateCategoryProgress(category) {
            if (!videoFiles[category]) return;
            
            const totalLevels = videoFiles[category].length;
            let completedLevels = 0;
            
            if (userProgress[category]) {
                for (let i = 0; i < totalLevels; i++) {
                    if (userProgress[category][i] === true) {
                        completedLevels++;
                    }
                }
            }
            
            const progressPercent = Math.round((completedLevels / totalLevels) * 100);
            document.getElementById('category-progress').style.width = `${progressPercent}%`;
            document.getElementById('category-progress-text').textContent = `${completedLevels}/${totalLevels}`;
        }
        
        // Update global progress display
        function updateGlobalProgress() {
            let totalLevels = 0;
            let completedLevels = 0;
            
            // Calculate total and completed levels across all categories
            for (const category in videoFiles) {
                const levels = videoFiles[category].length;
                totalLevels += levels;
                
                if (userProgress[category]) {
                    for (let i = 0; i < levels; i++) {
                        if (userProgress[category][i] === true) {
                            completedLevels++;
                        }
                    }
                }
            }
            
            const progressPercent = Math.round((completedLevels / totalLevels) * 100);
            document.getElementById('global-progress').style.width = `${progressPercent}%`;
            document.getElementById('progress-percent').textContent = `${progressPercent}%`;
        }
        
        // Display experiences in archives
        function displayExperiences() {
            const archivesList = document.getElementById('archives-list');
            archivesList.innerHTML = '';
            
            if (userExperiences.length === 0) {
                archivesList.innerHTML = '<li style="padding: 10px; text-align: center;">No saved experiences yet</li>';
                return;
            }
            
            userExperiences.forEach(exp => {
                const li = document.createElement('li');
                li.style.padding = '10px';
                li.style.borderBottom = '1px solid #7e57c2';
                
                // Generate star rating
                let stars = '';
                for (let i = 0; i < 5; i++) {
                    if (i < exp.rating) {
                        stars += '<i class="fas fa-star" style="color: gold;"></i>';
                    } else {
                        stars += '<i class="far fa-star" style="color: #ccc;"></i>';
                    }
                }
                
                li.innerHTML = `
                    <strong>${categoryTitles[exp.category]}</strong> - Level ${exp.level}<br>
                    <div style="margin: 5px 0;">${stars}</div>
                    <small>${exp.date}: "${exp.text}"</small>
                `;
                archivesList.appendChild(li);
            });
        }
        
        // Clear all archives
        function clearArchives() {
            if (confirm('Are you sure you want to clear all saved experiences?')) {
                userExperiences = [];
                localStorage.removeItem('illusionExperiences');
                displayExperiences();
            }
        }
        
        // Play the same illusion again
        function playAgain() {
            autoSaveExperience();
            showScreen('video-screen');
        }
        
        // Play next level if available
        function playNextLevel() {
            autoSaveExperience();
            const nextLevel = currentLevel + 1;
            
            if (nextLevel < videoFiles[currentCategory].length) {
                // Make sure next level is unlocked
                if (isLevelCompleted(currentCategory, currentLevel)) {
                    currentLevel = nextLevel;
                    showScreen('video-screen');
                } else {
                    alert('Please complete the current level first!');
                }
            } else {
                alert('You have completed all levels in this category!');
                showScreen('level-screen');
            }
        }
        
        // Go to home screen
        function goToHome() {
            autoSaveExperience();
            showScreen('home-screen');
        }
        
        // Load settings from localStorage
        function loadSettings() {
            const savedSettings = localStorage.getItem('illusionSettings');
            if (savedSettings) {
                try {
                    const settings = JSON.parse(savedSettings);
                    
                    // Apply settings
                    document.getElementById('sound-toggle').checked = settings.sound || false;
                    document.getElementById('animations-toggle').checked = settings.animations || true;
                    document.getElementById('motion-toggle').checked = settings.motion || false;
                    document.getElementById('autosave-toggle').checked = settings.autosave || true;
                    
                    // Apply sliders
                    document.getElementById('brightness-slider').value = settings.brightness || 100;
                    document.getElementById('contrast-slider').value = settings.contrast || 100;
                    document.getElementById('saturation-slider').value = settings.saturation || 100;
                    
                    // Apply theme
                    changeTheme(settings.theme || 'purple', false);
                } catch (e) {
                    console.error("Error loading settings:", e);
                }
            }
        }
        
        // Save settings to localStorage
        function saveSettings() {
            const settings = {
                sound: document.getElementById('sound-toggle').checked,
                animations: document.getElementById('animations-toggle').checked,
                motion: document.getElementById('motion-toggle').checked,
                autosave: document.getElementById('autosave-toggle').checked,
                brightness: document.getElementById('brightness-slider').value,
                contrast: document.getElementById('contrast-slider').value,
                saturation: document.getElementById('saturation-slider').value,
                theme: document.querySelector('.theme-option.active').dataset.theme
            };
            
            localStorage.setItem('illusionSettings', JSON.stringify(settings));
            alert('Settings saved successfully!');
            showScreen('home-screen');
        }
        
        // Change theme
        function changeTheme(theme, save = true) {
            // Remove active class from all themes
            document.querySelectorAll('.theme-option').forEach(opt => {
                opt.classList.remove('active');
            });
            
            // Add active class to selected theme
            const themeOption = document.querySelector(`.theme-option[data-theme="${theme}"]`);
            if (themeOption) {
                themeOption.classList.add('active');
            }
            
            // Change body gradient
            const gradients = {
                purple: 'linear-gradient(135deg, #0f0c29, #302b63, #24243e)',
                blue: 'linear-gradient(135deg, #0f1b31, #1a2980, #0d3b66)',
                red: 'linear-gradient(135deg, #2c0f29, #b21f1f, #2c0f29)',
                green: 'linear-gradient(135deg, #0d2929, #1f6b1f, #0d2929)',
                dark: 'linear-gradient(135deg, #121212, #333, #000)',
                rainbow: 'linear-gradient(135deg, #ff0000, #ff9900, #ffff00, #00ff00, #00ffff, #0000ff, #9900ff)'
            };
            
            document.body.style.background = gradients[theme] || gradients.purple;
            
            // Save if requested
            if (save) {
                const savedSettings = localStorage.getItem('illusionSettings');
                const settings = savedSettings ? JSON.parse(savedSettings) : {};
                settings.theme = theme;
                localStorage.setItem('illusionSettings', JSON.stringify(settings));
            }
        }
        
        // Reset progress
        function resetProgress() {
            if (confirm('Are you sure you want to reset all progress? This will clear your archives and settings.')) {
                localStorage.clear();
                userExperiences = [];
                userProgress = {};
                loadSettings();
                alert('All progress has been reset!');
                showScreen('home-screen');
            }
        }
        
        // Reset all data (new function)
        function resetAll() {
            if (confirm('Are you sure you want to reset ALL data? This will completely wipe your progress, archives, and settings.')) {
                localStorage.clear();
                userExperiences = [];
                userProgress = {};
                // Reset form elements
                document.getElementById('user-experience').value = '';
                currentRating = 0;
                document.querySelectorAll('.rating-star').forEach(star => {
                    star.classList.remove('active');
                });
                
                alert('All data has been reset! The application is now in its initial state.');
                location.reload(); // Refresh to apply all changes
            }
        }
    </script>
</body>
</html>